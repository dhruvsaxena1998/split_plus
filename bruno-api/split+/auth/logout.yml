info:
  name: logout
  type: http
  seq: 3

http:
  method: POST
  url: "{{base_url}}/auth/logout"
  headers:
    - name: Authorization
      value: "Bearer {{access_token}}"
      enabled: true
  body:
    type: json
    data: |-
      {
        "refresh_token": "{{refresh_token}}"
      }
  auth: none

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5

tests:
  script: |-
    test("should return 200 OK", function() {
      expect(res.status).to.equal(200);
    });

    test("should have success message", function() {
      expect(res.body.data.message).to.equal("logged out successfully");
    });

    // Clear tokens from environment
    bru.setEnvVar("access_token", "");
    bru.setEnvVar("refresh_token", "");

docs: |
  # Logout

  Logs out the current user by invalidating their refresh token and blacklisting their access token.

  ## Headers
  - `Authorization`: Bearer token (access token)

  ## Request Body
  - `refresh_token` (required): Refresh token to invalidate

  ## Response
  Returns success message:
  - `message`: "logged out successfully"

  ## Status Codes
  - `200 OK`: Successfully logged out
  - `401 Unauthorized`: Invalid or missing access token
  - `500 Internal Server Error`: Server error during logout

  ## What Happens
  1. The refresh token is deleted from the sessions table
  2. The access token's JTI is added to the blacklist (expires in 7 days)
  3. Both tokens become immediately invalid

  ## Usage
  After logout, both tokens are cleared from environment variables. You'll need to login again to get new tokens.

  ## Example Response
  ```json
  {
    "status": true,
    "data": {
      "message": "logged out successfully"
    }
  }
  ```

  ## Notes
  - Requires both access token (in header) and refresh token (in body)
  - Access token is blacklisted to prevent immediate reuse
  - Blacklisted tokens are automatically cleaned up after 7 days
